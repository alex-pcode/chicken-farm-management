# Story 4.3: Enhanced Layout Components with shadcn

## Status  
Ready for Development

## Story
**As a** developer,  
**I want** accessible layout and modal components with neumorphic styling,  
**so that** I can create consistent user interface patterns with improved functionality.

## Acceptance Criteria
1. Install shadcn layout component dependencies
   - Add `dialog`, `card`, `table`, `pagination`, `sheet` components via shadcn CLI
   - Install `@radix-ui/react-dialog` for enhanced modal accessibility
2. Create hybrid layout components
   - Build `NeuDialog` component with neumorphic modal styling and proper focus management
   - Build `NeuTable` component with enhanced sorting, filtering, and keyboard navigation
   - Build `AnimatedNeuCard` component integrating Framer Motion with neumorphic styling
3. Implement accessibility improvements
   - Ensure all components support keyboard navigation and screen readers
   - Add proper ARIA labels and focus management
   - Implement escape key handling and focus trapping for modals
4. Create integration examples
   - Enhance existing data tables with shadcn functionality
   - Update modal usage patterns across the application
   - Provide migration guide for existing `Modal.tsx` and `DataTable.tsx` components

## Integration Verification
- IV1: All existing modals and tables continue to work with identical behavior
- IV2: Enhanced accessibility features work correctly with assistive technologies
- IV3: Animation integration maintains existing Framer Motion timing and effects
- IV4: Performance impact is neutral or positive with new architecture

## Tasks / Subtasks
- [ ] Install shadcn layout component dependencies (AC: 1)
  - [ ] Run `npx shadcn@latest add dialog card table pagination sheet`
  - [ ] Install `npm install @radix-ui/react-dialog` for enhanced modal features
  - [ ] Verify component imports and basic functionality
  - [ ] Test default shadcn layout components
- [ ] Create NeuDialog hybrid component (AC: 2)
  - [ ] Build `src/components/epic4/modals/NeuDialog.tsx`
  - [ ] Apply neumorphic styling to DialogContent with rounded borders and shadows
  - [ ] Implement proper focus management and focus trapping
  - [ ] Add support for trigger, title, and children props
  - [ ] Create TypeScript interface for dialog configuration
- [ ] Create NeuTable hybrid component (AC: 2)
  - [ ] Build `src/components/epic4/tables/NeuTable.tsx`
  - [ ] Apply neumorphic card styling to table container
  - [ ] Implement enhanced sorting functionality with visual indicators
  - [ ] Add keyboard navigation support for table rows and cells
  - [ ] Create flexible data rendering with renderRow prop pattern
- [ ] Create AnimatedNeuCard hybrid component (AC: 2)
  - [ ] Build `src/components/epic4/layout/AnimatedNeuCard.tsx`
  - [ ] Integrate Framer Motion with existing animation presets
  - [ ] Apply neumorphic card styling (`neuStyles.card`)
  - [ ] Add hover effects with enhanced shadow transitions
  - [ ] Support multiple animation variants (fadeIn, slideUp, scaleIn, cardEntrance)
- [ ] Implement accessibility improvements (AC: 3)
  - [ ] Add comprehensive keyboard navigation support
  - [ ] Implement proper ARIA labels and roles for all components
  - [ ] Add focus management with visible focus indicators
  - [ ] Implement escape key handling for modal components
  - [ ] Test with screen reader software (NVDA/JAWS)
- [ ] Create integration examples (AC: 4)
  - [ ] Enhanced CRM customer table using NeuTable
  - [ ] Modal dialog examples for data entry and confirmation
  - [ ] AnimatedNeuCard usage in dashboard and stats display
  - [ ] Migration guide from existing `Modal.tsx` to `NeuDialog`
  - [ ] Migration guide from existing `DataTable.tsx` to `NeuTable`
- [ ] Integration verification testing (All IVs)
  - [ ] Test existing modals and tables remain functional (IV1)
  - [ ] Run assistive technology testing (screen readers, keyboard navigation) (IV2)
  - [ ] Verify Framer Motion animations work correctly with new components (IV3)
  - [ ] Performance testing with React DevTools Profiler (IV4)

## Component Specifications

### NeuDialog Component
```typescript
interface NeuDialogProps {
  trigger?: React.ReactNode
  title?: string
  children: React.ReactNode
  open?: boolean
  onOpenChange?: (open: boolean) => void
}
```
- **Styling**: Neumorphic modal with rounded corners and depth shadows
- **Accessibility**: Focus trapping, escape key handling, ARIA labeling
- **Features**: Configurable trigger, title, and content areas

### NeuTable Component
```typescript
interface NeuTableProps {
  headers: string[]
  data: any[]
  renderRow: (item: any, index: number) => React.ReactNode[]
  className?: string
}
```
- **Styling**: Neumorphic card container with styled table rows
- **Features**: Flexible data rendering, hover effects, responsive design
- **Accessibility**: Keyboard navigation, proper table semantics

### AnimatedNeuCard Component
```typescript
interface AnimatedNeuCardProps {
  children: React.ReactNode
  className?: string
  animation?: 'fadeIn' | 'slideUp' | 'scaleIn' | 'cardEntrance'
}
```
- **Styling**: Neumorphic card with hover shadow transitions
- **Animation**: Framer Motion integration with existing presets
- **Features**: Multiple animation variants, responsive design

## Accessibility Requirements
- **WCAG AA Compliance**: All components must meet accessibility standards
- **Keyboard Navigation**: Full functionality available via keyboard
- **Screen Reader Support**: Proper ARIA labels and semantic HTML
- **Focus Management**: Visible focus indicators and logical tab order
- **Color Contrast**: Maintain contrast ratios for neumorphic design

## Technical Implementation Notes
- **Base Components**: Built on shadcn/ui + Radix UI for accessibility foundation
- **Animation Integration**: Seamless Framer Motion integration with existing motion presets
- **Styling Strategy**: Neumorphic styling applied via `neuStyles` utilities
- **Performance**: Lazy loading and memoization for complex table components

## Definition of Done
- [ ] All shadcn layout dependencies installed and working
- [ ] NeuDialog, NeuTable, and AnimatedNeuCard components created and tested
- [ ] Accessibility improvements implemented and verified
- [ ] Integration examples created with migration documentation
- [ ] All integration verifications pass
- [ ] Accessibility testing confirms WCAG AA compliance
- [ ] Performance testing shows neutral or positive impact
- [ ] Animation integration maintains existing Framer Motion behavior