# Story 14.1: Fix Egg Entry Table Display Issue

## Status
üîÑ **In Progress**

## Story
**As a user logging daily eggs with size and color enabled, I want to see the size and color data displayed in the Recent Entries table, so that I can verify my entries were saved correctly.**

## Problem Description
When users enable advanced egg tracking (size & color) and log egg entries, the data is correctly saved to the Supabase database but does not appear in the Recent Entries table. The table only shows id, date, and count fields, missing the size, color, and notes columns.

## Root Cause Analysis
**Issue:** Two different API endpoints are being called with different data completeness:
1. **OptimizedDataProvider** ‚Üí `/data?type=all` ‚Üí ‚úÖ Returns 8 fields including size/color
2. **useEggData fallback** ‚Üí `/data?type=production` ‚Üí ‚ùå Returns only 3 fields (id, date, count)

The useEggData hook is incorrectly choosing the fallback data source over the context data, resulting in incomplete field display.

## Technical Details

### Data Flow Investigation
- ‚úÖ **Database**: Has size/color columns with correct constraints
- ‚úÖ **API Endpoint**: `/data?type=all` correctly selects all columns  
- ‚úÖ **Server Response**: Returns complete data with 8 fields
- ‚úÖ **Frontend Reception**: BaseApiService receives all 8 fields
- ‚ùå **Component Display**: Only shows 3 fields due to wrong data source

### Current Status
- Fixed conditional spread operator logic in EggCounter for data saving
- Added comprehensive debugging throughout the data pipeline
- Identified that useEggData hook chooses fallback over context data
- Need to investigate why OptimizedDataProvider context data is not being used

## Acceptance Criteria
- [ ] Egg entries table displays size and color columns when available
- [ ] Previously saved entries with size/color data appear correctly
- [ ] New entries with size/color save and display immediately
- [ ] Table gracefully handles entries without size/color (shows "-")
- [ ] No performance degradation in table rendering

## Tasks
- [x] Investigate table display issue and data flow
- [x] Fix EggCounter data saving logic (conditional spread operators)
- [x] Add debugging to track data pipeline
- [x] Identify root cause: wrong data source selection in useEggData
- [ ] Fix useEggData to properly use OptimizedDataProvider context data
- [ ] Remove debugging logs after fix verification
- [ ] Test complete egg entry workflow
- [ ] Verify table performance with large datasets

## Dev Notes
**Key Finding:** The issue is NOT in the table rendering or API endpoints, but in the data source selection logic within useEggData hook. The OptimizedDataProvider correctly provides complete data, but the hook falls back to ProductionService which returns incomplete data.

**Next Steps:** 
1. Debug why contextEntries from OptimizedDataProvider is empty/invalid
2. Fix data source selection logic in useEggData
3. Ensure OptimizedDataProvider data loads before fallback triggers

## Testing
- Manual testing with size/color enabled entries
- Verify existing entries display correctly
- Test new entry creation and immediate display
- Check table with mixed entries (some with/without size/color)

## QA Results
*To be updated after implementation*

---
**Story File:** `docs/stories/14.1.fix-egg-entry-table-display-issue.md`  
**Created:** 2025-08-23  
**Last Updated:** 2025-08-23